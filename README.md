# Automated Malware Analysis

This repository contains an automated malware analysis script that leverages multiple threat intelligence sources and a sandboxed environment to analyze potentially malicious files, URLs, IP addresses, and file hashes.

## Features

- Multi-source threat intelligence analysis:
  - VirusTotal
  - AbuseIPDB (for IP addresses)
  - AlienVault OTX
- Sandboxed analysis using Docker
- Interactive file system exploration within the sandbox
- Support for analyzing multiple inputs in a single run
- Flexible analysis options

## Requirements

- Python 3.6+
- Docker
- Python packages (see `requirements.txt`)

## Setup

1. Clone this repository:
   ```
   git clone https://github.com/your-username/automated-malware-analysis.git
   cd automated-malware-analysis
   ```

2. Install the required Python packages:
   ```
   pip install -r requirements.txt
   ```

3. Install and start Docker on your system if not already running.

4. Set up your `.env` file with the necessary API keys (see [API Integration](#api-integration) section).

## Usage

Run the script with one or more inputs to analyze:

```
python automated-malware-analysis.py <file_path|url|ip|hash> [additional_inputs...]
```

Example:
```
python automated-malware-analysis.py suspicious_file.exe http://suspicious-url.com 192.168.1.1
```

The script will prompt you to select which analyses you want to run for each input.

## API Integration

This script integrates with the following APIs:

1. VirusTotal API
2. AbuseIPDB API
3. AlienVault OTX API

To use these APIs, you need to obtain API keys from their respective websites and add them to your `.env` file:

```
VIRUSTOTAL_API_KEY=your_virustotal_api_key
ABUSEIPDB_API_KEY=your_abuseipdb_api_key
ALIENVAULT_OTX_API_KEY=your_alienvault_otx_api_key
```

## Sandbox Environment

The script creates a lightweight Docker container as a sandbox environment for safely analyzing potentially malicious files. The sandbox uses an Alpine Linux base image with Python 3 and the `file` utility installed.

## Results

Analysis results are saved in a unique directory named `analysis_results_<UUID>` in the current working directory. This directory contains:

- A TAR archive of all results from the sandbox container
- Individual JSON files for each analysis performed (VirusTotal, AbuseIPDB, AlienVault OTX)
- A text file with the sandbox analysis report

## Security Considerations

- The script runs potentially malicious files in a sandboxed Docker container with limited privileges and no network access.
- API keys are loaded from a `.env` file, which should be kept secure and not committed to version control.
- Always exercise caution when dealing with potentially malicious files or indicators.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Disclaimer

This tool is for educational and research purposes only. The authors are not responsible for any misuse or damage caused by this program. Always ensure you have proper authorization before analyzing any files or systems you do not own.

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request
